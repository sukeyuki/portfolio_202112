<!DOCTYPE html>
<html lang=ja>
    <head>
	    <meta charset="utf-8">
        <title>Portfolio</title>
    	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    	<title>main </title>
    	<meta name ="description" content = "予定を管理するツール">
    	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    	<link href="https://fonts.googleapis.com/css?family=Philosopher" rel="stylesheet">
    	<link rel="icon" type="image/png" href = "images/favicon.png">
    

        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <%= csrf_meta_tags %>
        <%= csp_meta_tag %>	
	    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
        <%= javascript_pack_tag 'application' %>
    </head>

    <body>
        <div id = "header" class = "border flex">
            <%=link_to"planning with", root_url, id:"logo"%>
            <%unless @first_day==nil%>
                <%if @first_day.month == @first_day.since(6.day).month%>
                    <div id = "year_and_month"><%=@first_day.year%>年<%=@first_day.month%>月</div>
                <%elsif @first_day.month != @first_day.since(6.day).month%>
                    <%if @first_day.year == @first_day.since(6.day).year%>
                        <div id = "year_and_month"><%=@first_day.year%>年<%=@first_day.month%>月〜<%=@first_day.since(6.day).month%>月</div>
                    <%elsif @first_day.year != @first_day.since(6.day).year%>
                        <div id = "year_and_month"><%=@first_day.year%>年<%=@first_day.month%>月〜<%=@first_day.since(6.day).year%>年<%=@first_day.since(6.day).month%>月</div>
                    <%end%> 
                <%end%>
            <%end%>
            <%unless @current_user==nil%>
                <%= image_tag "profile_icon.png", id:"my_profile", size:'70x70', data:{toggle:"modal",target:"#my_profile_modal"}%>
            <%end%>
        </div>

    <%= yield %>

    <!-- Modal my profile -->
    <div class="modal fade" id="my_profile_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">my profile</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body my_profile_wrapper">
                    <%unless @user==nil || @user.id==nil%>
                        <%= image_tag "profile_icon.png", class:"icon" ,size:'100x100'%>
                        <br>

                        <h3><%=@user.name%></h3>
                        <br>
                        <%="id:"+@user.search_name%>
                        <br>
                        <%="email:"+@user.email%>
                    <%end%>
                </div>
                <div class="modal-footer">
                    <%=link_to "Log out", destroy_user_session_url, method: :delete, type:"button", class:"btn btn-primary"%>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>



<%# <a id = "errors_modal_button" class = "group" type="button" data-toggle="modal" data-target="#errors_modal">test</a> %>
<%# <a id = "errors_modal_button" class = "group" type="button" data-toggle="modal" data-target="#errors_modal" style="display: none;">test</a> %>

    <!-- Modal errors -->
    <div class="modal fade" id="errors_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Error Messages</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <%if flash[:schedule].class == Array%>
                    <%flash[:schedule]&.each do |e| %>
                    <%=e%>
                    <br>
                    <%end%>
                <%elsif flash[:schedule].class == String%>
                  <%=flash[:schedule]%>
                <%end%>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

    <%unless flash[:create_schedule_error] == nil %>
        <script>
            $("#create_schedule").trigger("click");
        </script>
    <%end%>
    <%unless flash[:update_schedule_error] == nil %>
        <script>
            // $("#<%=@wrong_schedule_id%>-0-schedule-block").trigger("click");
            $("#<%=@wrong_schedule_id%>-0-schedule-block").click();
            // $("#schedule_edit").trigger("click");
            // $("#schedule_edit").click();
        </script>
    <%end%>


  </body>
</html>
